# Bayes åˆ†ç±»å™¨

[TOC]



å¤§é“è‡³ç®€ã€‚:yin_yang: ç®€å•çš„ç­‰å¼ï¼Œç®€å•çš„å‡è®¾ï¼›è¿™ä¸ªä¸–ç•Œä¸Šæœ€è´¨æœ´çš„æœºå™¨å­¦ä¹ ã€‚:crystal_ball:

ç®€æ´çš„å…¬å¼ç…§å°„å‡ºç†æ€§çš„å…‰è¾‰ã€‚:candle:

**å…³é”®è¯ï¼š**Bayeså…¬å¼ï¼ŒBayesåˆ†ç±»ï¼Œå…ˆéªŒ-åéªŒæ¦‚ç‡ï¼Œæ¡ä»¶ç‹¬ç«‹æ€§ï¼Œç‰¹å¾-æ ‡ç­¾ï¼Œåˆ†å¸ƒ

![](bayes.jpeg)

## åŸç†:triangular_ruler:

### Bayes å…¬å¼

$p$æ˜¯éšæœºå˜é‡$X, Y$çš„å¯†åº¦å‡½æ•°
$$
p(y|x)=\frac{p(x|y)p(y)}{p(x)},\\
p(y|x,\theta)=\frac{p(x|y,\theta)p(y,\theta)}{p(x,\theta)} ~~~~~~~~~~~~~~~~~(å‚æ•°å½¢å¼)
$$
*è¯æ˜* è¿™æ˜¯ä¸€ä¸ªæ’ç­‰å¼ï¼ï¼ï¼:astonished:

#### è§£é‡Š

$x$æ˜¯éšæœºå˜é‡ï¼Œ$y$æ˜¯å¾…ä¼°è®¡å‚æ•°(ä¹Ÿæ˜¯éšæœºå˜é‡)

Bayesä¼°è®¡ä¸­çš„ç§°è°“ï¼š

- $p(x|y)$ä¼¼ç„¶æ¦‚ç‡ï¼ˆæ¡ä»¶æ¦‚ç‡ï¼‰
- $p(y)$å…ˆéªŒæ¦‚ç‡
- $p(y|x)$åéªŒæ¦‚ç‡
- $p(x)=\int p(x|y)p(y)\mathrm{d} y$å…¨æ¦‚ç‡
- $p(x,y)=p(x|y)p(y)$è”åˆæ¦‚ç‡

### å–œé—»ä¹è§çš„ä¾‹å­

#### æ•™ç§‘ä¹¦å¼çš„ä¾‹å­ï¼šå‘å‹-æ€§åˆ«:books:

$x$:å‘å‹ï¼Œ$y$:æ€§åˆ«

è°ƒæŸ¥å‘ç°ç”·ç”Ÿ98%çŸ­å‘ï¼Œ2%é•¿å‘ï¼Œå¥³ç”Ÿ95%é•¿å‘ï¼Œ5%çŸ­å‘ã€‚æŸé™¢æ ¡ç”·å¥³æ¯”ä¾‹3ï¼š1ã€‚é—®é•¿ï¼ˆçŸ­ï¼‰å‘çš„ç”·å¥³æ¯”ä¾‹ï¼Ÿ

è°ƒæŸ¥å‘ç°ç”·ç”Ÿå‘é•¿æœä»$N(5,0.1^2)$ï¼Œå¥³ç”Ÿæœä»$N(40,5^2)$ã€‚æŸé™¢æ ¡ç”·å¥³æ¯”ä¾‹3ï¼š1ã€‚é—®å‘é•¿$x$çš„ç”·å¥³æ¯”ä¾‹ï¼Ÿ

#### å…«å¦å¿…å¤‡ï¼šæ˜Ÿåº§-çˆ±æƒ…:leo:

$x_1$:ç”·æ–¹æ˜Ÿåº§ï¼Œ$x_2$:å¥³æ–¹æ˜Ÿåº§ï¼Œ$y$:æ˜¯å¦èˆ¬é…

æ˜Ÿåº§åˆ†å¸ƒä¸æ€§åˆ«æ— å…³$p(x_1)=p(x_2)$,ä¸”ç›¸å¯¹äº$y$æ¡ä»¶ç‹¬ç«‹ã€‚ä¼°è®¡ä»»æ„ä¸€ç§æ˜Ÿåº§ç»„åˆèˆ¬é…å¯èƒ½æ€§ã€‚

#### è‡´å‘½ç—…æ¯’â€”â€”è´å¶æ­»( Bayes death)

$x$: æ£€æµ‹æ˜¯å¦æ„ŸæŸ“ï¼Œ$y$:æ˜¯å¦çœŸçš„æ„ŸæŸ“

æŸåœ°åŒºçˆ†å‘"è´å¶æ­»â€ç—…æ¯’ç–«æƒ…ï¼Œä¼°è®¡æœ‰æ€»äººå£çš„1/10000è¢«æ„ŸæŸ“ã€‚å¦‚æœä½ è¢«æ£€æµ‹ç²¾åº¦ä¸º99%çš„ä»ªå™¨åˆ¤æ–­ä¸ºè¢«æ„ŸæŸ“ï¼Œé—®ä½ çœŸçš„è¢«æ„ŸæŸ“çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ

## æœ´ç´ Bayesåˆ†ç±»:balance_scale:

![](bayes.png)

æ¨¡å‹åç§°ï¼š

**æœ´ç´ Bayesåˆ†ç±»å™¨**

æœ¯è¯­ï¼š

- æ¨¡å‹è¾“å…¥/**å±æ€§attributeï¼ˆç‰¹å¾featureï¼‰**$x=(x_1,x_2,\cdots,x_n)$

- æ¨¡å‹è¾“å‡º/**ç±»åˆ«classï¼ˆæ ‡ç­¾labelï¼‰**$c$

å‡è®¾ï¼š

- æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼š$p(x|c)=\prod_ip(x_i|c)$

- æ¦‚ç‡æ¨¡å‹ï¼š$p(x_i|c)=f_{c,i}(x_i)$ (ä¸€èˆ¬é‡‡ç”¨åŒåˆ†å¸ƒå½¢å¼$p(x_i|c)=f_{c}(x_i)$)

*æ€è€ƒï¼šä¸ºä»€ä¹ˆå¼•å…¥æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼Ÿå®ƒçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Œä»£ä»·æ˜¯ä»€ä¹ˆï¼Ÿ*:thinking:



*æ³¨ï¼šä¸¥æ ¼çš„å†™æ³•æ˜¯$P(X_i=x_i|c)=p_i(x_i|c)$, ä½œä¸ºå‡½æ•°$p_i(\cdot|c)$æ˜¯ä¸ä¸€å®šç›¸åŒçš„ã€‚:paw_prints:*



è®­ç»ƒæ•°æ®ï¼ˆæ ·æœ¬ï¼‰ï¼š

| $x_1$:è¡€å‹:syringe: | $x_2$:æ˜Ÿåº§:libra: | $c$æ¸£ä¸æ¸£:label: |
| ---------- | ---------- | --------- |
| O          | å°„æ‰‹       | æ˜¯        |
| AB         | åŒå­       | ä¸        |
|A|é‡‘ç‰›|ä¸|
|B|å¤©ç§¤|ä¸|

æµ‹è¯•æ•°æ®ï¼š
| $x_1$:è¡€å‹ | $x_2$:æ˜Ÿåº§ | $c$æ¸£ä¸æ¸£ |
| ---------- | ---------- | --------- |
| AB          | å°„æ‰‹       | æ˜¯        |
| A          | å¤©ç§¤       | ä¸        |

*æ³¨ï¼šæ²¡æœ‰æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼ŒæŸäº›æµ‹è¯•æ•°æ®å› ä¸ºæ²¡æœ‰åœ¨è®­ç»ƒæ•°æ®ä¸­å‡ºç°è¿‡ï¼Œå…¶æ¦‚ç‡å¯èƒ½è¢«è¯¯åˆ¤ä¸º0ï¼Œæ— æ³•åšå‡ºåˆ¤æ–­ã€‚æœ‰äº†è¿™ä¸ªå‡è®¾ï¼Œåªè¦æµ‹è¯•æ ·æœ¬æ¯ä¸ªå±æ€§éƒ½åœ¨è®­ç»ƒæ ·æœ¬ä¸­å‡ºç°è¿‡å°±ä¸ä¼šå‡ºç°è¿™ç±»è¯¯åˆ¤ï¼Œåˆ†ç±»å™¨æ‰æœ‰æ³›åŒ–èƒ½åŠ›ã€‚è¿™æ ·åšä¹Ÿæœ‰ä»£ä»·ï¼Œå› ä¸ºå±æ€§å¾ˆå¯èƒ½å…·æœ‰ç›¸å…³æ€§ï¼Œè¯¯å·®æ˜¯ä¸å¯é¿å…çš„ã€‚*

### åŸºæœ¬å…¬å¼

ç±»åˆ«é¢„æµ‹$\hat{c}(x)=\arg\max_cp(c|x)$ã€‚ (**MAPä¼°è®¡**)
$$
p(c|x)\sim \prod_ip(x_i|c)p(c)= \prod_ip(x_i,c)p(c)^{1-n}\\
\sim \prod_ip(c|x_i)p(c)^{1-n},\\
\ln p(c|x)\sim \sum_i\ln p(x_i,c)+(1-n)\ln p(c)\\
$$

*è¿™é‡Œçœç•¥å¸¸æ•°é¡¹$p(x)$*:paw_prints:

*æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼ŒæŠŠå¤šå…ƒï¼ˆé«˜ç»´ï¼‰å‡½æ•°çš„æ‹Ÿåˆ$p(c|x)$ï¼Œåˆ†è§£æˆä¸€å…ƒï¼ˆä½ç»´ï¼‰å‡½æ•°çš„æ‹Ÿåˆ$p(c|x_i)$ã€‚æœ´ç´ Bayesæ˜¯ä¸€ç§å¯åŠ æ¨¡å‹$f(x)=\sum_if_i(x_i)$ã€‚*

### ä¼°è®¡


$$
\hat{p}(c|x)\sim\prod_i\hat{p}(x_i,c)\hat{p}(c)^{1-n}\\
\sim\prod_i\hat{p}(c|x_i)\hat{p}(c)^{1-n}
$$

*è¿™é‡Œçœç•¥å¸¸æ•°é¡¹ã€‚*ğŸ¾



### 0-1 æƒ…å½¢

$$
r = \ln\frac{p(1|x)}{1-p(1|x)}\sim \sum_i\ln\frac{\hat{p}_1(x_i)}{1-\hat{p}_1(x_i)}+(1-n)\ln\frac{\hat{p}_1}{1-\hat{p}_1} \\
$$

å½“ $r\geq 0$, $x$æ˜¯ 1 ç±», å¦åˆ™ 0 ç±».



### æµç¨‹:play_or_pause_button:

æ•°æ®åˆ†ææµç¨‹

1. ç¡®å®šå±æ€§$x$ï¼Œç¡®å®šç±»åˆ«$c$ï¼Œæ”¶é›†æ•°æ®

2. ä¼°è®¡$\hat{p}(c),\hat{p}(x_i|c)$æˆ–è€…$\hat{p}(x_i,c)$

   å¯¹ç¦»æ•£éšæœºå˜é‡å¸¸ç”¨é¢‘æ•°ä¼°è®¡ï¼Œå¦‚$\hat{p}(x_i,c)=\frac{N (x_i,c)}{N}$ï¼Œå¯¹äºè¿ç»­éšæœºå˜é‡æˆ–è€…å€¼åŸŸè¿‡å¤§çš„æ•°å­—å‹ç¦»æ•£éšæœºå˜é‡æ¨èç”¨æ ¸ä¼°è®¡ï¼ˆå¦‚è¿‘é‚»ä¼°è®¡ï¼‰ï¼Œæ›´å¥½çš„æ˜¯æä¾›å‚æ•°åˆ†å¸ƒã€‚*éæ•°å­—å‹éšæœºå˜é‡åªèƒ½ç”¨é¢‘æ•°ä¼°è®¡* :construction:

3. è®¡ç®—$\hat{p}(c|x)$

4. é¢„æµ‹$\hat{c}(x)$



*æ³¨ï¼šå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œ$c$æ˜¯æœ‰é™ç¦»æ•£çš„ï¼Œä¸€èˆ¬ç”¨é¢‘æ•°ä¼°è®¡$\hat{p}(c)$ï¼Œå¦åˆ™æ¨èç”¨æ ¸å¯†åº¦ä¼°è®¡ã€‚*:paw_prints:



## å¯†åº¦å‡½æ•°ä¼°è®¡ä¸é€‰æ‹©ğŸ²

*æœ€å…³é”®çš„æ˜¯å¯†åº¦å‡½æ•°çš„ä¼°è®¡ã€‚å› ä¸ºç°å®ä¸­ï¼Œé€šå¸¸å¹¶ä¸çŸ¥é“çœŸå®çš„æ¡ä»¶æ¦‚ç‡ï¼Œå¿…é¡»ä»æ•°æ®ä¸­ä¼°è®¡å‡ºæ¥ã€‚*:key:

### éå‚æ•°æ¨¡å‹

- å…ˆéªŒæ¦‚ç‡çš„ä¼°è®¡

$\hat{p}(c)=\frac{N(c)}{N}$ã€‚

- è”åˆå¯†åº¦ã€æ¡ä»¶å¯†åº¦çš„ä¼°è®¡

$\hat{p}(x,c)=\frac{N(x,c)}{N}, N(x,c):$  $c$ç±»ä¸­$x$ï¼ˆé™„è¿‘ï¼‰æ ·æœ¬æ•°ï¼Œ$N$æ ·æœ¬æ€»ä¸ªæ•°

$\hat{p}(x|c)= \frac{N(x,c)}{N(c)}, N(x,c):$  $c$ç±»ä¸­$x$ï¼ˆé™„è¿‘ï¼‰æ ·æœ¬æ•°, $N(c)$: $c$ç±»æ ·æœ¬ä¸ªæ•°

- å¹³æ»‘ï¼š $\hat{p}(x|c)=\frac{N(x,c)+1}{N+S}$, $S$æ˜¯$x$å–å€¼æ€»æ•°ã€‚ $\hat{p}(c)=\frac{N(c)+1}{N+K}$, $K$æ˜¯ç±»åˆ«æ•°ã€‚

*è¿ç»­å€¼åˆ†å¸ƒå¯é‡‡ç”¨æ ¸å¯†åº¦ä¼°è®¡ã€‚*

### å‚æ•°æ¨¡å‹

å‚æ•°æ¨¡å‹åªéœ€ä¼°è®¡å‚æ•°ï¼Œä½†è¦åˆç†é€‰æ‹©å‚æ•°åˆ†å¸ƒã€‚

è®¾åˆ†å¸ƒä¸º$p(x|c,\theta)$, åˆ™$\hat{p}(x|c)=p(x|c,\hat{\theta})$ã€‚

å¸¸ç”¨åˆ†å¸ƒï¼š
- Gaussian åˆ†å¸ƒ: $p(x|c,\mu,\sigma^2)\sim N(\mu,\sigma^2)$
- å¤šé¡¹å¼åˆ†å¸ƒ: $p(x|c,p)\sim M(p)=M(p_1,p_2,\cdots)$
- Bernoulli åˆ†å¸ƒ: $p(x|c,p)\sim B(p)$



*å¯¹äºå›å½’é—®é¢˜ï¼Œ$c$æ˜¯è¿ç»­çš„ï¼Œ$p(c)$å¯ä»¥é‡‡ç”¨æ ¸å¯†åº¦ä¼°è®¡ã€‚æˆ–è€…å‡å®šä¸ºGaussianåˆ†å¸ƒã€‚*

## æ–‡æœ¬åˆ†ç±»ä¾‹å­:sa:

*æ–‡æœ¬åˆ†ç±»å¤§æ¦‚æ˜¯æ˜¯Bayesä¼°è®¡æœ€å‡ºè‰²çš„åº”ç”¨ï¼Œæ–‡æœ¬åˆ†ç±»çš„ç‰¹ç‚¹æ˜¯è¦å¤„ç†éæ•°å­—å‹éšæœºå˜é‡*

æ–‡æ¡£$d$ï¼šæ–‡å­—é›†åˆ$\{w_i\}$æ„æˆçš„åºåˆ—

- å¤šé¡¹å¼æ¨¡å‹: ï¼ˆå¯¹äº$x_i$ä¸æ˜¯æ¡ä»¶ç‹¬ç«‹çš„/æœ´ç´ Bayesçš„:paw_prints:ï¼‰

  ç¬¬$i$ä¸ªå±æ€§$x_i$æ˜¯$w_i$å‡ºç°æ¬¡æ•°ã€‚$(x_i=\sharp \{w\in d ,w=w_i\})\sim M(p)$ 

- æ–‡å­—åºåˆ—æ¨¡å‹(=å¤šé¡¹å¼æ¨¡å‹):ï¼ˆå¯¹äº$d_i$æ˜¯æœ´ç´ Bayesçš„ï¼‰

  $x_i=d_i$ï¼Œ$d$çš„ç¬¬$i$ä¸ªæ–‡å­—

- Bernoulli æ¨¡å‹:

  ç¬¬$i$ä¸ªå±æ€§$x_i$æ˜¯$w_i$æ˜¯å¦å‡ºç°ã€‚$x_i = w_i \in d\sim B(p_i)$ 

>  çˆ±çš„ä¾›å…» =
>     {æŠŠä½ æ”¾åœ¨æ‰‹ä¸Š è™”è¯šåœ°ç„šé¦™
>     å‰ªä¸‹ä¸€æ®µçƒ›å…‰ å°†ç»çº¶ç‚¹äº®
>     ä¸æ±‚è¡æ°”å›è‚  åªæ±‚çˆ±ä¸€åœº
>     çˆ±åˆ°æœ€åå—äº†ä¼¤ å“­å¾—å¥½ç»æœ›
>     æˆ‘ç”¨å°½ä¸€ç”Ÿä¸€ä¸– æ¥å°†ä½ ä¾›å…»
>     åªæœŸç›¼ä½ åœä½ æµè½¬çš„ç›®å…‰
>     è¯·èµäºˆæˆ‘æ— é™çˆ± ä¸è¢«çˆ±çš„åŠ›é‡
>     è®©æˆ‘èƒ½å®‰å¿ƒåœ¨è©æä¸‹ é™é™çš„è§‚æƒ³
>     æˆ‘ç”¨å°½ä¸€ç”Ÿä¸€ä¸– æ¥å°†ä½ ä¾›å…»
>     äººä¸–é—´æœ‰å¤ªå¤šçš„ çƒ¦æ¼è¦å¿˜
>     è‹¦æµ·ä¸­é£˜è¡ç€ä½  é‚£æ—§æ—¶çš„æ¨¡æ ·
>     ä¸€å›å¤´å‘ç° æ—©å·²è¸å‡ºäº†çº¢å°˜ä¸‡ä¸ˆ}

å¤šé¡¹å¼æ¨¡å‹:

- ç‰¹å¾ï¼š$x_1$:"æŠŠâ€å­—æ•°, $x_2$:"ä½ â€å­—æ•°,...

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šçˆ±çš„ä¾›å…»ã€‹=(æŠŠ=1,ä½ =5,æ”¾=1,...ä¸€=7ï¼Œâ€¦) = (1,5,1,â€¦7,...)

- è¾“å‡ºï¼šçˆ±æƒ…ç±»


æ–‡å­—åºåˆ—æ¨¡å‹(=å¤šé¡¹å¼æ¨¡å‹)

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šçˆ±çš„ä¾›å…»ã€‹=(ç¬¬ä¸€ä¸ªå­—=æŠŠ,ç¬¬äºŒä¸ªå­—=ä½ ,...) = (æŠŠï¼Œä½ ï¼Œâ€¦)

- è¾“å‡ºï¼šçˆ±æƒ…ç±»

Bernoulli æ¨¡å‹:

- ç‰¹å¾ï¼š$x_1$:"æŠŠâ€æ˜¯å¦å‡ºç°, $x_2$:"ä½ â€æ˜¯å¦å‡ºç°,...

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šçˆ±çš„ä¾›å…»ã€‹=(æŠŠ=1,ä½ =1,æ”¾=1,...ä¸€=1ï¼Œâ€¦,) = (1,5,1,â€¦7,...)

- è¾“å‡ºï¼šçˆ±æƒ…ç±»

> æˆ‘å’Œæˆ‘çš„ç¥–å›½=
> {æˆ‘å’Œæˆ‘çš„ç¥–å›½
> ä¸€åˆ»ä¹Ÿä¸èƒ½åˆ†å‰²
> æ— è®ºæˆ‘èµ°åˆ°å“ªé‡Œ
> éƒ½æµå‡ºä¸€é¦–èµæ­Œ
> æˆ‘æ­Œå”±æ¯ä¸€åº§é«˜å±±
> æˆ‘æ­Œå”±æ¯ä¸€æ¡æ²³
> è¢…è¢…ç‚ŠçƒŸ å°å°æ‘è½
> è·¯ä¸Šä¸€é“è¾™
> æˆ‘æœ€äº²çˆ±çš„ç¥–å›½
> æˆ‘æ°¸è¿œç´§ä¾ç€ä½ çš„å¿ƒçª
> ä½ ç”¨ä½ é‚£æ¯äº²çš„è„‰æ
> å’Œæˆ‘è¯‰è¯´
> æˆ‘çš„ç¥–å›½å’Œæˆ‘
> åƒæµ·å’ŒæµªèŠ±ä¸€æœµ
> æµªæ˜¯é‚£æµ·çš„èµ¤å­
> æµ·æ˜¯é‚£æµªçš„ä¾æ‰˜
> æ¯å½“å¤§æµ·åœ¨å¾®ç¬‘
> æˆ‘å°±æ˜¯ç¬‘çš„æ—‹æ¶¡
> æˆ‘åˆ†æ‹…ç€æµ·çš„å¿§æ„
> åˆ†äº«æµ·çš„æ¬¢ä¹
> æˆ‘æœ€äº²çˆ±çš„ç¥–å›½
> ä½ æ˜¯å¤§æµ·æ°¸ä¸å¹²æ¶¸
> æ°¸è¿œç»™æˆ‘ç¢§æµªæ¸…æ³¢
> å¿ƒä¸­çš„æ­Œ}


å¤šé¡¹å¼æ¨¡å‹:

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šæˆ‘å’Œæˆ‘çš„ç¥–å›½ã€‹=(æŠŠ=0,ä½ =3,æ”¾=0,...ä¸€=6ï¼Œâ€¦) = (1,3,0,â€¦6,...)
- è¾“å‡ºï¼šä¸»æ—‹å¾‹

æ–‡å­—åºåˆ—æ¨¡å‹(=å¤šé¡¹å¼æ¨¡å‹)

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šæˆ‘å’Œæˆ‘çš„ç¥–å›½ã€‹=(ç¬¬ä¸€ä¸ªå­—=æˆ‘,ç¬¬äºŒä¸ªå­—=å’Œ,...) = (æˆ‘ï¼Œå’Œï¼Œâ€¦)

- è¾“å‡ºï¼šçˆ±æƒ…ç±»

Bernoulli æ¨¡å‹:

- è¾“å…¥ï¼šæ–‡æ¡£ã€Šæˆ‘å’Œæˆ‘çš„ç¥–å›½ã€‹=(æŠŠ=0,ä½ =1,æ”¾=0,...ä¸€=1ï¼Œâ€¦,) = (0,1,1,â€¦1,...)

- è¾“å‡ºï¼šä¸»æ—‹å¾‹



æ··åˆBayesæ¨¡å‹ï¼šç”¨Bernoulli æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œç”¨å¤šé¡¹å¼æ¨¡å‹è¿›è¡Œé¢„æµ‹

*Bernoulli æ¨¡å‹ç›¸å½“äºæŠŠå¤šé¡¹å¼æ¨¡å‹çš„æ–‡æœ¬ä¸­é‡å¤å‡ºç°çš„æ–‡å­—å‹ç¼©æˆä¸€ä¸ªå­—ã€‚*:paw_prints:



*æ€è€ƒ1*ğŸ¤”åˆ©ç”¨ä¸€äº›æ–‡æœ¬ç‰¹æœ‰çš„è§„å¾‹(å¦‚Zipfå®šå¾‹)ï¼Œäº†è§£ä¸€ä¸‹`tfidf`

å±æ€§$x_1$: å‡ºç°æœ€å¤šçš„å­—ï¼Œ$x_2$å‡ºç°ç¬¬äºŒå¤šçš„å­—,...

*æ€è€ƒ2*ğŸ¤”åˆ©ç”¨è¯å‘é‡ï¼ŒPCAé™ç»´

*æ€è€ƒ2*ğŸ¤”å¤šé¡¹å¼æ¨¡å‹å’ŒBernoulli æ¨¡å‹å„è‡ªçš„ä¼˜ç¼ºç‚¹

*æ³¨ï¼šå¤šé¡¹å¼æ¨¡å‹å¯¹äº$x_i$ä¸æ˜¯ä¸ç®—æœ´ç´ Bayesï¼Œå¯¹äº$d_i$æ‰æ˜¯ï¼*:construction:

## å®ç°:computer:

### scikit-learnå®ç°

```python
import numpy as np
X = np.random.randint(2, size=(6, 100))
Y = np.array([1, 2, 2, 2, 3, 3])
from sklearn.naive_bayes import BernoulliNB, GaussianNB, MutlinomialNB
clf = BernoulliNB()
clf.fit(X, Y)
# BernoulliNB(alpha=1.0, binarize=0.0, class_prior=None, fit_prior=True)
print(clf.predict(X[2:3]))
```



### nltkå®ç°

```python
import nltk
...
featrues = ...
train, test = get_train_test(featrues)
classifier = nltk.NaiveBayesClassifier.train(train)
acc = nltk.classify.accuracy(classifier, test)
```



#### ä¸ªäººä½œå“

[äººå-æ€§åˆ«æ¨æµ‹](https://github.com/Freakwill/name_gender/blob/master/README.md)

[æ–‡æœ¬åˆ†ç±»](https://github.com/Freakwill/text-classifier)

[çº¯æ‰‹å·¥å®ç°](https://github.com/Freakwill/Thomas)

## æ‰©å±•âš›ï¸

è¶…è¶Šè‡ªæˆ‘ï¼Œæˆå°±å“è¶Šã€‚

### åŠæœ´ç´  Bayes

å¦‚æœ $y$ æ˜¯ç©ºçš„ï¼Œè¿™ç­‰ä»·äºæœ´ç´ ç‰ˆæœ¬ã€‚ç”¨å…¶ä»–æœºå™¨å­¦ä¹ æ–¹å¼è®¡ç®—$f_c(y)$ï¼Œ$y$é€šå¸¸æ˜¯è¿ç»­éšæœºå˜é‡ã€‚
$$
p(c|x,y)
\sim \prod_ip(x_i|c)p(c|y)\\
\sim \prod_ip(x_i|c)f_c(y)\\
\sim \prod_ip(x_i,c)f_c(y)p(c)^{-n}
$$

### 0-1 æƒ…å½¢

$$
r = \ln\frac{p(1|x,y)}{1-p(1|x,y)}\sim \sum_i\ln\frac{\hat{p}_1(x_i)}{1-\hat{p}_1(x_i)}+\ln\frac{f_1(y)}{1-f_1(y)}+n\ln\frac{\hat{p}_1}{1-\hat{p}_1} \\
$$

å½“ $r\geq 0$, $(x,y)$ 1ç±», å¦åˆ™ 0ç±».

*å‚è€ƒï¼šAdditive Logistic Regression*



## æ€»ç»“

å…³äºæœ´ç´ Bayesåˆ†ç±»

- ä¼˜ç‚¹ï¼š
  1. é€šç”¨æ€§ã€æ³›åŒ–æ€§å¥½
  2. æ¨¡å‹ç®€å•ã€è®¡ç®—ç®€å•å¿«é€Ÿ
  3. åˆ†ç±»xæ•ˆæœè‰¯å¥½
- ç¼ºç‚¹ï¼š
  1. å‡è®¾ç²—æµ…ï¼ŒåéªŒæ¦‚ç‡éå¸¸ä¸å‡†ç¡®ï¼ˆåªæ˜¯æœ€å¤§åéªŒä¼°è®¡æ¯”è¾ƒå‡†ç¡®zï¼‰
  2. ä¾èµ–å…ˆéªŒæ¦‚ç‡ï¼Œæœ‰æ—¶ä¹Ÿéœ€è¦ç¡®å®šæ¡ä»¶æ¦‚ç‡çš„å½¢å¼
  3. éœ€è¦æ­£ç¡®é€‰æ‹©æ ·æœ¬å±æ€§

## å‚è€ƒ

https://blog.csdn.net/qiu_zhi_liao/article/details/90671932

https://blog.csdn.net/rongrongyaofeiqi/article/details/53100391

Raymond Chiong, Lau Bee Theng. A Hybrid Naive Bayes Approach for Information Filtering.



## å½©è›‹:egg:

å¹çˆ† wuli Bayes~ğŸ˜±

![](bigbang.jpg)

